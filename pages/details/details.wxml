<view>
  <view id='b-detail-top'>
    <view class='taewtw' wx:if='{{ loginStaus==0 }}' bindtap="goRegister">ç«‹é©¬æ³¨å†Œï¼Œèººç€èµšé’±ï¼Œé€Ÿé€Ÿæ¥æŠ¢</view>
    <view class='taewtw' wx:if='{{ loginStaus==1 }}' bindtap="goAuth">ç«‹é©¬è®¤è¯ï¼Œèººç€èµšé’±ï¼Œé€Ÿé€Ÿæ¥æŠ¢</view>
  </view>
  <scroll-view scroll-y='true' style='height: {{ scrollHeight }}px' wx:if="{{ adInfo }}">
    <view class='detail-container'>
      <view class="page-section page-section-spacing swiper">
        <swiper indicator-dots="true" circular="true" autoplay="true" interval="3000" duration="800" class="swiper-banner bg-white"
          style='height:{{bannerHeight+"px"}};width:{{windowWidth+"px"}}'>
          <block wx:for="{{ adInfo.banners }}" wx:key="item.id">
            <swiper-item>
              <image src="{{ item }}" mode="scaleToFill" style='height:{{bannerHeight+"px"}};width:{{windowWidth+"px"}}'></image>
            </swiper-item>
          </block>
        </swiper>
      </view>
      <!-- å¹¿å‘ŠçŠ¶æ€ -->
      <view class="profile-wrapper">
        <block>
          <view class="profile frpro">
            <view class="profile-item cwsfts">{{ adInfo.ad_name }}</view>
            <view class='profile-ad-status'>
              <view>
                <text class="time  {{ (item.run_status === 0  ||item.run_status === 2  || item.run_status === 3)? 'timetxt2' : '' }}{{ item.run_status === 4?  'timetxt' : ''}}">{{
                    adInfo.adStatusStr }}</text>
              </view>
            </view>
          </view>
        </block>
        <block>
          <view class="profile">
            <!-- é¢„è®¡æ”¶ç›Š -->
            <view class="profile-item">
              <view class='profole-type'>é¢„è®¡æ”¶ç›Š:</view>
            </view>
            <block wx:if="{{ loginStaus != 3 }}">
              <view class="profole-type-right tasts">***ï¼ˆèº«ä»½è®¤è¯åå¯æŸ¥çœ‹æ”¶ç›Šï¼‰</view>
            </block>
            <block wx:elif="{{  adInfo.billing_mode == 0 }}">
              <view class="profole-type-right red-text">ï¿¥{{ adInfo.predict_amount }}</view>
            </block>
            <block wx:elif='{{ adInfo.billing_mode == 1 }}'>
              <view class="profole-type-right red-text" bindtap='goValuation'>
                <view class='b-income-explain-wrapper'>
                  <view>ï¿¥{{ adInfo.min_amount }}
                    <label class="data-blt2">~ </label>{{ adInfo.max_amount }}</view>
                  <image class='b-explain-icon' src='https://wxapi.benpaobao.com/static/app_img/v2/b-theme-explain.png'></image>
                </view>
              </view>
            </block>
          </view>
        </block>
        <!-- å¹¿å‘Šç±»å‹ -->
        <block>
          <view class='profile'>
            <view class="profile-item">
              <text>å¹¿å‘Šç±»å‹:</text>
            </view>
            <view class="right-text">
              <label class="data-text swtwxs" wx:if="{{ adInfo.classify == 0 }}">è½¦å°¾</label>
              <label class="data-text swtwxs" wx:if="{{ adInfo.classify == 1 }}">è½¦å†…</label>
              <label class="data-text swtwxs" wx:if="{{ adInfo.classify == 2 }}">è½¦å°¾+è½¦å†…</label>
              <label class="data-text swtwxs" wx:if="{{ adInfo.classify == 3 }}">è½¦å†…+è½¦å¤–</label>
              <label class="data-text swtwxs" wx:if="{{ adInfo.classify == 4 }}">è½¦å¤–</label>
            </view>
          </view>
        </block>
        <block>
          <view class="profile">
            <view class="profile-item">æ”¶ç›Šæ—¶é—´:</view>
            <view class="right-text">{{ adInfo.begin_date }}
              <label class="data-blt">~</label>{{ adInfo.end_date }}</view>
          </view>
        </block>
        <block wx:if="{{ adInfo.reserve_date.start_date && adInfo.reserve_date.last_date }}">
          <view class="profile">
            <view class="profile-item">å®‰è£…æ—¶é—´:</view>
            <view class="right-text">{{ adInfo.reserve_date.start_date }}
              <label class="data-blt">~</label>{{ adInfo.reserve_date.last_date }}</view>
          </view>
        </block>
        <block>
          <view class="profile">
            <view class="profile-item">è½¦è¾†è¦æ±‚:</view>
            <view class="right-text horizontal-center" bindtap='handleColorExplain'>
              <image class='b-car-require' src='https://wxapi.benpaobao.com/static/app_img/v2/b-theme-explain.png'></image>
              <text class="b-require-text" catchtap='handleRequire' data-require='{{  adInfo.car_require }}'>{{
                adInfo.car_require }}</text>
            </view>
          </view>
        </block>
        <block>
          <view class="profile">
            <view class="profile-item">è½¦è¾†é¢œè‰²:</view>
            <view class="right-text b-color-content" bindtap='handleCarColor' data-color='{{ carColor }}'>{{ carColor
              }}</view>
          </view>
        </block>
      </view>

      <!-- å‚ä¸åˆ—è¡¨ -->
      <view class='join-list-wrapper' wx:if='{{ showJoining }}' bindtap='joinClick'>
        <view class='join-left-layout'>
          <text class='already-join-text'>å·²å‚ä¸</text>
          <text class='already-join-number'>{{ joinCount + 'äºº'}}</text>
        </view>
        <view class='join-center-line'></view>
        <scroll-view class='join-avatar-scroll' scroll-x='true'>
          <view class='join-avatar-wrapper' wx:for='{{ avatarList }}' wx:for-item='item' wx:key='index'>
            <view class='join-avatar-item'>
              <image class='join-avatar' src='{{ item.wx_avatar }}'></image>
            </view>
          </view>
        </scroll-view>
        <view>
          <image class='arrow-image' src='../../image/arrow.png'></image>
        </view>
      </view>
      <!-- æ’é˜Ÿä¸­åˆ—è¡¨ -->
      <view class='join-list-wrapper queue' wx:if='{{ showWaiting }}' bindtap='queueClick'>
        <view class='join-left-layout'>
          <text class='already-join-text'>æ’é˜Ÿä¸­</text>
          <text class='already-join-number'>{{ queueCount + 'äºº'}}</text>
        </view>
        <view class='join-center-line'></view>
        <scroll-view class='join-avatar-scroll' scroll-x='true'>
          <view class='join-avatar-wrapper' wx:for='{{ queueList }}' wx:for-item='item' wx:key='index'>
            <view class='join-avatar-item'>
              <image class='join-avatar' src='{{ item.wx_avatar }}'></image>
            </view>
          </view>
        </scroll-view>
        <view>
          <image class='arrow-image' src='../../image/arrow.png'></image>
        </view>
      </view>
      <!-- å¹¿å‘Šä»‹ç»å’Œè®¾è®¡æ ·å¼é¢„è§ˆ -->
      <view class='b-design-container'>
        <view class='b-design-introduce'>
          <view class='b-ad-introduce-title'>å¹¿å‘Šä»‹ç»</view>
          <view class='b-ad-introduce-content'>
            <text>{{ adInfo.introduction }}</text>
          </view>
        </view>
        <view>
          <view class='b-ad-design-title'>å¹¿å‘Šè®¾è®¡é¢„è§ˆ</view>
          <view>
            <view wx:for="{{ designList }}" wx:for-item='design' class='b-design-wrapper' wx:key='design.id'>
              <view class='b-design-item-title'>{{ design.title }}</view>
              <scroll-view scroll-x='true' class="b-scroll-effect">
                <view class='b-effect-wrapper'>
                  <view id='effect-image' class='b-effect-image-wrapper' wx:for='{{ design.effect }}' wx:for-item='effect'
                    wx:key='effect.id'>
                    <image class='b-effect-image' src='{{ effect.img }}' bindtap='handlePreviewDesign' data-effect='{{ design.effect }}'
                      data-current='{{ effect.img }}'></image>
                    <view class="b-effect-desc">
                      <text>{{ effect.desc }}</text>
                    </view>
                  </view>
                </view>
              </scroll-view>
            </view>
          </view>
        </view>
      </view>
    </view>
  </scroll-view>

  <!-- åº•éƒ¨åˆ†äº«é¢„çº¦æŒ‰é’® -->
  <view class='action_bottom {{ adInfo? "action_bottom_visible" : "action_bottom_invisible" }}' id="b-detail-bottom">
    <!-- å®¢æœ -->
    <button class='wtwabt' open-type='contact'>
      <image src='https://wxapi.benpaobao.com/static/app_img/v2/b_message_icon.png'></image>
      <view class='sharetext'>åœ¨çº¿å®¢æœ</view>
    </button>
    <!-- åˆ†äº« -->
    <button data-adName="{{adInfo.name}}" class='wtwabt' bindtap='shareDetailListener'>
      <image src='https://wxapi.benpaobao.com/static/app_img/v2/b_share_icon.png'></image>
      <view class='sharetext'>{{ shareAwardText }}</view>
    </button>
    <!-- é¢„çº¦æ’é˜Ÿ -->
    <view class='subscribe_immediately b-start-subscribe {{ actionStatus === 0 || actionStatus === 4 || actionStatus === 5 || actionStatus === 6? "b-action-disenable" : "" }}'
      bindtap='handleAction'>
      <view class='subcribe-wrapper'>
        <text>{{ actionStr }}</text>
      </view>
    </view>
  </view>
</view>

<!-- é¢„çº¦æˆåŠŸå¼¹æ¡† -->
<dialog showDialog='{{showGoodsDetail}}' bind:btnclick='dialogClickListener' title='é¢„çº¦æˆåŠŸ' description='åˆ†äº«ç»™å¾®ä¿¡å¥½å‹ï¼Œè®©ä½ çš„æœ‹å‹ä»¬ä¸€èµ·èµšé’±å§!'
  btnText='åˆ†äº«å¾®ä¿¡å¥½å‹' />
<view class="scrollUp" wx:if="{{goHome}}" bindtap="backHome">
  <view class="count">
  </view>
</view>
<bpb-reward reward='{{reward}}'></bpb-reward>
<share-popup showPop='{{ showSharePop }}' bind:shareMoment='shareMomentListener' adId="{{ adInfo.id }}"></share-popup>

<!-- æœ‹å‹åœˆåˆ†äº« -->
<share-detail avatar='{{ shareAvatar }}' nickname='{{ shareNickname }}' incomeMoney='{{ incomeMoney }}' joinNumber='{{ joinNumber }}'
  joinAvatarList='{{ joinAvatarList }}' adImageUrl='{{ adImageUrl }}' adName='{{ adName }}' adTime='{{ adTime }}'
  showShareModel='{{ showShareModel }}' adId='{{adId}}' bind:hideDialog='hideDialogListener'>
</share-detail>

<!--æ­£åœ¨åŠ è½½-->
<view class='load-more' hidden='{{!isShowLoadingMore}}'>
  <view class="weui-loadmore">
    <view class="weui-loading"></view>
    <view class="weui-loadmore__tips" style='color:#999999'>å¥”è·‘ä¸­ğŸš—...</view>
  </view>
</view>

<!-- è§„åˆ™å¼¹æ¡† -->
<rule-dialog showRuleDialog='{{ showRule }}' bind:btnclick='iKnow' bind:btnclickDetail='goRuleDetail' data-adId="{{ adId }}"
  data-serverId="{{ serverId }}" data-serverName='{{ serverName }}' data-serverAddress='{{ serverAddress }}'></rule-dialog>

<!-- åœ°å€å¼¹æ¡† -->
<dialog-address showAddressDialog='{{ showAddressDialog }}' address='{{ address }}' phone='{{ phone }}'></dialog-address>

<!-- æ³¨å†Œè®¤è¯å¼¹æ¡† -->
<dialog-auth showDialog='{{ showAuthDialog }}' imageSrc='{{ "https://wxapi.benpaobao.com/static/app_img/auth-icon.png" }}'
  btnStr='{{ authStr }}' status='{{ authStatus }}' content='{{ authContent }}' bind:action='handleActionTap'></dialog-auth>

<!-- é¢„çº¦æ’é˜Ÿ -->
<model visible="{{ visible }}" title="é¢„çº¦æ’é˜Ÿç¡®è®¤" cancelText="æš‚ä¸æ’é˜Ÿ" confirmText="ç¡®è®¤æ’é˜Ÿ" cancelLoading="{{ cancelLoading }}"
  confirmLoading="{{ confirmLoading }}" bind:cancel="handleQueueCancel" bind:confirm="handleQueueConfirm" explain='æ’é˜Ÿè¯´æ˜'
  bind:explain="handleModelExplain">
  <view class='subscribe-wrapper'>
    <view class='subscribe-body'>
      <view class='b-queue-model-item'>æ’é˜Ÿåºå·: {{ serial_number }}</view>
      <view class='b-queue-model-item'>å½“å‰æ’é˜Ÿäººæ•°: {{ queue_count }}</view>
      <view class='b-queue-model-item'>éœ€ç­‰å¾…äººæ•°: {{ position }}</view>
    </view>
    <view class='b-queue-notify-text'>è¯·åŠæ—¶å…³æ³¨å…¬ä¼—å·é€šçŸ¥ï¼ŒæŸ¥çœ‹æ’é˜Ÿæƒ…å†µã€‚</view>
  </view>
</model>

<!-- å–æ¶ˆæ’é˜Ÿ -->
<model visible="{{ visibleUndo }}" title="å–æ¶ˆç¡®è®¤" cancelText="æš‚ä¸å–æ¶ˆ" confirmText="ç¡®è®¤å–æ¶ˆ" confirmLoading="{{ doLoading }}"
  bind:cancel="handleUndoCancel" bind:confirm="handleConfirmCancel">
  <view class='subscribe-wrapper'>
    <view class='b-cancel-queue-tip'>
      <view class='b-queue-model-item'>å–æ¶ˆåï¼Œéœ€é‡æ–°å‚åŠ æ’é˜Ÿï¼Œ</view>
      <view class='b-queue-model-item'>æ‚¨ç¡®è®¤å–æ¶ˆå½“å‰æ’é˜Ÿå—ï¼Ÿ</view>
    </view>
  </view>
</model>

<!-- å¹´æ£€å¼¹çª— -->
<model visible="{{ visibleAnnual }}" title="å®Œå–„è½¦è¾†å¹´æ£€æ—¥æœŸ" cancelText="å–æ¶ˆ" confirmText="ä¿å­˜" confirmLoading="{{ annualLoading }}"
  bind:cancel="handleAnnualCancel" bind:confirm="handleAnnualConfirm">
  <view class='b-annual-container'>
    <view class='b-annual-left'>
      <text>å¹´æ£€æ—¥æœŸ: </text>
    </view>
    <picker-view indicator-style="height: 50px;" class='b-picker-view' value="{{value}}" bindchange="bindAnnualChange">
      <picker-view-column>
        <view wx:for="{{months}}" wx:key='item.id' class='b-pick-item'>{{item}}æœˆ</view>
      </picker-view-column>
      <picker-view-column>
        <view wx:for="{{days}}" wx:key='item.id' class='b-pick-item'>{{item}}æ—¥</view>
      </picker-view-column>
    </picker-view>
  </view>
</model>

<!-- ç¡®è®¤é¢„çº¦æç¤º -->
<model visible="{{ visibleSubscribeTip }}" title="é¢„çº¦ç¡®è®¤" cancelText="æš‚ä¸é¢„çº¦" confirmText="ç¡®è®¤é¢„çº¦" confirmLoading="{{ confirmSubTipLoading }}"
  bind:cancel="handleSubscribeCancel" bind:confirm="handleSubscribeRequest">
  <view class='subscribe-wrapper'>
    <view class='subscribe-body'>
      <view class='b-queue-model-item'>æœåŠ¡ç½‘ç‚¹: {{ subscribeStation }}</view>
      <view class='b-queue-model-item'>é¢„çº¦æ—¶é—´: {{ subscribeTime }}</view>
      <view class='b-queue-model-item'>ç½‘ç‚¹åœ°å€: {{ subscribeAddress }}</view>
    </view>
  </view>
</model>

<!-- é¢„çº¦å¼¹çª— -->
<popup show="{{ visibleSubscribe }}" type="bottom" bindclose="toggleBottomPopup" overlay="{{true}}">
  <view class='b-subscribe-container'>
    <view class='b-subscribe-header'>
      <view class='b-header-wrapper'>
        <image class='b-subscribe-logo' src='{{ adInfo.logo }}' mode='aspectFill'></image>
        <view class='b-header-right'>
          <view class='b-header-info'>
            <view class='b-header-money b-theme-color'>
              <text class='b-money-symbol'>ï¿¥</text>
              <block wx:if='{{ adInfo.billing_mode == 0 }}'>
                <text class='b-money-number'>{{ adInfo.predict_amount}}</text>
              </block>
              <block wx:elif="{{ adInfo.billing_mode == 1 }}">
                <text class='b-money-number'>{{ adInfo.min_amount + "~" + adInfo.max_amount }}</text>
              </block>
            </view>
            <view class='b-header-remain'>å‰©ä½™{{ remainCount }}è¾†</view>
            <view class='b-header-select'>{{ selectStatusStr }}</view>
          </view>
        </view>
      </view>
    </view>
    <view>
      <scroll-view scroll-y="true" class='b-scroll-body'>
        <view class='b-scroll-content'>
          <!-- æœåŠ¡ç½‘ç‚¹ -->
          <view class='b-body-title'>
            <view class='b-title-wrapper'>
              <view class='b-body-color-title'>æœåŠ¡ç½‘ç‚¹</view>
              <view class='b-title-stauts' wx:if='{{ selectServerIndex === -1 }}'>è¯·é€‰æ‹©æœåŠ¡ç½‘ç‚¹</view>
            </view>
            <view class='b-body-wrapper'>
              <view class='b-body-server' wx:for="{{ stationList }}" wx:key="server" wx:if="{{ selectServerIndex === -1 || (selectServerIndex !== -1 &&  index === selectServerIndex) }}">
                <view class='b-server-cell {{ index === selectServerIndex? "b-server-select" : "b-server-normal" }}'
                  bindtap='handleServerClick' data-index='{{ index }}' data-station="{{ item }}">
                  <image class='b-server-logo' src="{{ item.small_logo || '../../image/noimg.png' }}" catchtap='handlePreviewStation'
                    data-image="{{ item.logo }}"></image>
                  <view class='b-server-right'>
                    <view class='b-server-right-middle'>
                      <view class='b-server-right-top'>
                        <view class='b-right-name {{ index === selectServerIndex? "b-theme-color" : "" }}'>{{
                          item.station_name }}</view>
                        <view class='b-right-distance'>{{ item.distance }}km</view>
                      </view>
                      <view class='b-right-address-wrapper'>
                        <image class='b-right-location-icon' src='../../image/dw.png'></image>
                        <view class='b-right-address'>{{ item.station_address }}</view>
                        <view class='b-go-map' catchtap='handleNavigation' data-nav="{{ item }}">
                          <image class='b-map-image' src='https://wxapi.benpaobao.com/static/app_img/v2/b-nav-icon.png'></image>
                          <view class='b-map-text'>
                            <text>å¯¼èˆª</text>
                          </view>
                        </view>
                      </view>
                    </view>
                  </view>
                </view>
              </view>
            </view>
          </view>
          <!-- é¢„çº¦æ—¥æœŸ -->
          <view class='b-body-title' wx:if='{{ selectServerIndex !== -1 }}'>
            <view class='b-title-wrapper'>
              <view class='b-body-color-title'>é¢„çº¦æ—¥æœŸ</view>
              <view class='b-title-stauts' wx:if='{{ selectDateIndex === -1 }}'>è¯·é€‰æ‹©é¢„çº¦æ—¥æœŸ</view>
            </view>
            <view class='b-body-wrapper'>
              <view class='b-body-date' wx:for="{{ dateList }}" wx:key="date" wx:if="{{ selectDateIndex === -1 || (selectDateIndex !== -1 &&  index === selectDateIndex) }}">
                <view class='b-date-cell {{ index === selectDateIndex? "theme-color" : (item.enable? "normal-color" : "gray-color") }} {{ index === selectDateIndex? "b-server-select" : "b-server-normal" }}'
                  bindtap="handleDateClick" data-index='{{ index }}' data-date="{{ item }}">{{ item.date }}</view>
              </view>
            </view>
          </view>
          <!-- é¢„çº¦æŸä¸ªæ—¥æœŸçš„æ—¶é—´æ®µ -->
          <view class='b-body-title' wx:if="{{ selectServerIndex !== -1 && selectDateIndex !== -1 }}">
            <view class='b-title-wrapper'>
              <view class='b-body-color-title'>é¢„çº¦æ—¶é—´</view>
              <view class='b-title-stauts' wx:if='{{ selectTimeIndex === -1 }}'>è¯·é€‰æ‹©é¢„çº¦æ—¶é—´</view>
            </view>
            <view class='b-body-wrapper'>
              <view class='b-body-date' wx:for="{{ timeList }}" wx:key="date" wx:if="{{ selectTimeIndex === -1 || (selectTimeIndex !== -1 &&  index === selectTimeIndex) }}">
                <view class='b-date-cell {{index === selectTimeIndex? "theme-color" : item.enable? "normal-color" : "gray-color" }} {{ index === selectTimeIndex? "b-server-select" : "b-server-normal" }}'
                  bindtap="handleTimeClick" data-index='{{ index }}' data-time="{{ item }}">{{ item.time }}</view>
              </view>
            </view>
          </view>
          <!-- è½¦èº«é¢œè‰² -->
          <view class='b-body-title b-body-title-color'>
            <view class='b-title-wrapper'>
              <view class='b-body-color-title'>è½¦èº«é¢œè‰²</view>
            </view>
            <view class='b-body-wrapper'>
              <view wx:for="{{ colorList }}" wx:key="color" class='b-body-color-item'>
                <view class='b-color-cell {{ item == userCarColor? "b-cell-select" : "b-cell-normal" }}'>{{ item }}</view>
              </view>
            </view>
          </view>
        </view>
      </scroll-view>
    </view>
    <view class='b-btn-wrapper'>
      <button class='b-subscribe-btn btn-enable' bindtap='handleConfirmSubscribe'>ç¡®è®¤é¢„çº¦</button>
    </view>
    <!-- å…³é—­æŒ‰é’® -->
    <view class='b-close' bindtap='handleSubscribeClose'>
      <image class='b-close-image' src='https://wxapi.benpaobao.com/static/app_img/close-gray.png'></image>
    </view>
  </view>
</popup>

<!-- è½»æç¤º -->
<b-toast id="toast"></b-toast>