<view>
  <view id='b-detail-top'>
    <view class='taewtw' wx:if='{{loginStaus==0}}' bindtap="goRegister">立马注册，躺着赚钱，速速来抢</view>
    <view class='taewtw' wx:if='{{loginStaus==1}}' bindtap="goAuth">立马认证，躺着赚钱，速速来抢</view>
  </view>
  <scroll-view scroll-y='true' style='height: {{ scrollHeight }}px'>
    <view class='detail-container'>
      <view class="page-section page-section-spacing swiper">
        <swiper indicator-dots="true" autoplay="true" interval="3000" duration="800" class="swiper-banner bg-white" style='height:{{bannerHeight+"px"}};width:{{windowWidth+"px"}}'>
          <block wx:for="{{banners}}" wx:key="item.id">
            <swiper-item>
              <image src="{{item}}" mode="scaleToFill" style='height:{{bannerHeight+"px"}};width:{{windowWidth+"px"}}'></image>
            </swiper-item>
          </block>
        </swiper>
      </view>
      <!-- 广告状态 -->
      <view class="profile-wrapper">
        <block>
          <view class="profile frpro">
            <view class="profile-item cwsfts">
              <text>{{adInfo.name}}</text>
            </view>
            <view class='profile-ad-status'>
              <view wx:if="{{adInfo.run_status==0}}">
                <text class="time timetxt2">即将开始</text>
              </view>
              <view wx:if="{{adInfo.run_status==1}}">
                <text class="time">剩余{{adInfo.current_count}}辆</text>
              </view>
              <view wx:if="{{adInfo.run_status==2}}">
                <text class="time timetxt2">投放中</text>
              </view>
              <view wx:if="{{adInfo.run_status==3}}">
                <text class="time timetxt2">检测中</text>
              </view>
              <view wx:if="{{adInfo.run_status==4}}">
                <text class="time timetxt">已结束</text>
              </view>
              <view>
                <text class="time timetxt b-total-count">(共{{ adInfo.total_count }}辆)</text>
              </view>
            </view>
          </view>
        </block>
        <block>
          <view class="profile">
            <!-- 预计收益 -->
            <view class="profile-item">
              <view class='profole-type'>预计收益:</view>
            </view>
            <view class="profole-type-right red-text" wx:if='{{ adInfo.amount != null && isDiDi != 1 }}'>￥{{ adInfo.amount }}</view>
            <view class="profole-type-right red-text" bindtap='goValuation' wx:elif='{{ isDiDi == 1 }}'>
              <view class='b-income-explain-wrapper'>
                <view>￥300
                  <label class="data-blt2">~ </label>868</view>
                <image class='b-explain-icon' src='https://wxapi.benpaobao.com/static/app_img/explain-theme-icon.png'></image>
              </view>
            </view>
            <view class="profole-type-right tasts" wx:elif='{{ adInfo.amount == null }}'>身份认证后可查看收益</view>
          </view>
        </block>
        <!-- 广告类型 -->
        <block>
          <view class='profile'>
            <view class="profile-item">
              <text>广告类型:</text>
            </view>
            <view class="right-text">
              <label class="data-text swtwxs" wx:if="{{adInfo.type==0}}">车尾</label>
              <label class="data-text swtwxs" wx:if="{{adInfo.type==1}}">车内</label>
              <label class="data-text swtwxs" wx:if="{{adInfo.type==2}}">车尾+车内</label>
              <label class="data-text swtwxs" wx:if="{{adInfo.type==3}}">车内+车外</label>
              <label class="data-text swtwxs" wx:if="{{adInfo.type==4}}">车外</label>
            </view>
          </view>
        </block>
        <block>
          <view class="profile">
            <view class="profile-item">收益时间:</view>
            <view class="right-text">{{adInfo.begin_date}}
              <label class="data-blt">~</label>{{adInfo.end_date}}</view>
          </view>
        </block>
        <block>
          <view class="profile">
            <view class="profile-item">安装时间:</view>
            <view class="right-text">{{adInfo.begin_date}}
              <label class="data-blt">~</label>{{adInfo.end_date}}</view>
          </view>
        </block>
        <block>
          <view class="profile">
            <view class="profile-item">车辆要求:</view>
            <view class="right-text horizontal-center" bindtap='handleColorExplain'>
              <text wx:if='{{ adInfo.city }}'>{{ adInfo.city}}</text>
            </view>
          </view>
        </block>
        <block>
          <view class="profile">
            <view class="profile-item">车辆颜色:</view>
            <view class="right-text horizontal-center" bindtap='handleColorExplain'>
              <image class='b-car-require' src='https://wxapi.benpaobao.com/static/app_img/explain-gray-icon.png'></image>
              <text>{{ carColor }}</text>
            </view>
          </view>
        </block>
      </view>

      <!-- 参与列表 -->
      <view class='join-list-wrapper' wx:if='{{showJoining}}' bindtap='joinClick'>
        <view class='join-left-layout'>
          <text class='already-join-text'>已参与</text>
          <text class='already-join-number'>{{ joinCount + '人'}}</text>
        </view>
        <view class='join-center-line'></view>
        <scroll-view class='join-avatar-scroll' scroll-x='true'>
          <view class='join-avatar-wrapper' wx:for='{{avatarList}}' wx:for-item='item' wx:key='index'>
            <view class='join-avatar-item'>
              <image class='join-avatar' src='{{item.wx_avatar}}'></image>
            </view>
          </view>
        </scroll-view>
        <view>
          <image class='arrow-image' src='../../image/arrow.png'></image>
        </view>
      </view>
      <!-- 排队中列表 -->
      <view class='join-list-wrapper queue' wx:if='{{ showWaiting }}' bindtap='queueClick'>
        <view class='join-left-layout'>
          <text class='already-join-text'>排队中</text>
          <text class='already-join-number'>{{ queueCount + '人'}}</text>
        </view>
        <view class='join-center-line'></view>
        <scroll-view class='join-avatar-scroll' scroll-x='true'>
          <view class='join-avatar-wrapper' wx:for='{{ queueList }}' wx:for-item='item' wx:key='index'>
            <view class='join-avatar-item'>
              <image class='join-avatar' src='{{ item.wx_avatar }}'></image>
            </view>
          </view>
        </scroll-view>
        <view>
          <image class='arrow-image' src='../../image/arrow.png'></image>
        </view>
      </view>
      <!-- 服务网点列表 -->
      <view class="protwo">
        <block wx:if="{{service.length>0}}">
          <view class='service-title-wrapper'>
            <view class="profile frpro">
              <view class="profile-item cwsfts">预约前往下列服务网点</view>
            </view>
          </view>
        </block>

        <view class='list-root-wrapper'>
          <!-- 列表 -->
          <view class='list-transform'>
            <block wx:for="{{service}}" wx:for-index="index" wx:key="item.id" wx:if='{{ !showMap }}'>
              <view class="itemcon {{item.lista==2?'curitem':''}}">
                <view class="item {{item.lista==2?'curitemList':''}}">
                  <image src='../../image/sev_tips.png' class='sev_tips' wx:if='{{index==0&&item.lista!=2&&haveLoca}}'></image>
                  <image src='../../image/already.png' class='sev_tips' wx:if='{{index==0&&item.lista==2}}'></image>
                  <image wx:if='{{item.small_logo!=null}}' src='{{item.small_logo}}' class='sev_logo' catchtap='previewImage' data-image='{{ item.logo }}' data-samllImage='{{item.small_logo}}'></image>
                  <image wx:if='{{item.small_logo==null}}' src='../../image/noimg.png' class='sev_logo'></image>
                  <view class="item-middle">
                    <view>
                      <text class="title">{{item.name}}</text>
                    </view>
                    <view class="myad-li" bindtap='showAddress' data-address='{{item}}'>
                      <view class="message">
                        <image src='../../image/dw.png'></image>{{item.address}}
                      </view>
                      <!-- <label class="province-text txtstx" wx:if='{{item.lista==2}}'>已预约{{selDate}} {{selTime}}</label> -->
                      <view class="mmtext">剩余车辆
                        <label class="province-text">{{item.ad_count-item.subscribe_count}}辆</label>

                      </view>
                    </view>

                  </view>
                  <view class="item_right">
                    <view>
                      <text class="time">{{item.distance}}km</text>
                    </view>
                    <view class="orgtext" bindtap="goMap" data-longitude="{{item.lng}}" data-latitude="{{item.lat}}" data-name="{{item.name}}" data-address="{{item.address}}">
                      <image src='../../image/dh.png'></image>导航
                    </view>
                    <view class="fastwx" wx:if='{{item.lista==1}}' bindtap="arrangement" data-adId="{{adId}}" data-serverId="{{item.id}}" data-serverName='{{ item.name }}' data-serverAddress='{{ item.address }}'> 预约</view>
                    <view class="fastwx3" wx:if='{{item.lista==2}}' bindtap="cancel"> 取消</view>
                    <view class="fastwx2" wx:if='{{item.lista==0}}'> 预约</view>
                  </view>
                </view>
                <view class='yy_time' wx:if='{{item.lista==2}}'>
                  <label class="province-text">已预约{{selDate}} {{selTime}}</label>
                </view>
              </view>
            </block>
          </view>
        </view>
      </view>
      <!-- 广告介绍和设计样式预览 -->
      <view class='b-design-container'>
        <view class='b-design-introduce'>
          <view class='b-ad-introduce-title'>广告介绍</view>
          <view class='b-ad-introduce-content'>
            <text>爱康健23周年品牌宣，爱康健23周年品牌宣，爱康健23周年品牌宣，爱康健23周年品牌宣，爱康健23周年品牌宣，爱康健23周年品牌宣，爱康健23周年品牌宣，爱康健23周年品牌宣，爱康健23周年品牌宣，爱康健23周年品牌宣，爱康健23周年品牌宣，爱康健23周年品牌宣，爱康健23周年品牌宣，爱康健23周年品牌宣，爱康健23周年品牌宣，爱康健23周年品牌宣，爱康健23周年品牌宣，爱康健23周年品牌宣。</text>
          </view>
        </view>
        <view>
          <view class='b-ad-design-title'>广告设计预览</view>
          <view>
            <view wx:for="{{ designList }}" wx:for-item='design' class='b-design-wrapper' wx:key='design.id'>
              <view class='b-design-item-title'>{{ design.title }}</view>
              <view wx:for="{{ design.effect }}" class='b-design-effect' wx:for-item='effect' wx:key='effect.id'>
                <image class='b-design-effect-image' src='{{ effect.src }}' bindtap='handlePreview' data-effect='{{ design.effect }}' data-index='{{ index }}' mode='widthFix'></image>
                <view class='b-design-effect-type'>{{ effect.type }}</view>
              </view>
              <view class='b-design-divider'></view>
            </view>
          </view>
        </view>
      </view>
    </view>
  </scroll-view>

  <!-- 底部分享预约按钮 -->
  <view class='action_bottom' id="b-detail-bottom">
    <!-- 分享 -->
    <button class='wtwabt' open-type='contact'>
      <image src='https://wxapi.benpaobao.com/static/app_img/v2/b_message_icon.png'></image>
      <view class='sharetext'>在线客服</view>
    </button>
    <!-- 分享 -->
    <button data-adName="{{adInfo.name}}" class='wtwabt' bindtap='shareDetailListener'>
      <image src='https://wxapi.benpaobao.com/static/app_img/v2/b_share_icon.png'></image>
      <view class='sharetext'>{{ shareAwardText }}</view>
    </button>
    <!-- 预约排队 -->
    <view class='subscribe_immediately {{ actionStatus === 1 ? "subscribe-focus" : "subscribe-unfocus" }}' bindtap='handleAction'>
      <view class='subcribe-wrapper'>
        <text>{{ actionStr }}</text>
      </view>
    </view>
  </view>
</view>

<!-- 预约成功弹框 -->
<dialog showDialog='{{showGoodsDetail}}' bind:btnclick='dialogClickListener' title='预约成功' description='分享给微信好友，让你的朋友们一起赚钱吧!' btnText='分享微信好友' />
<view class="scrollUp" wx:if="{{goHome}}" bindtap="backHome">
  <view class="count">
  </view>
</view>
<bpb-reward reward='{{reward}}'></bpb-reward>
<share-popup showPop='{{ showSharePop }}' bind:shareMoment='shareMomentListener' adId="{{ adInfo.id }}"></share-popup>

<!-- 朋友圈分享 -->
<share-detail avatar='{{ shareAvatar }}' nickname='{{ shareNickname }}' incomeMoney='{{ incomeMoney }}' joinNumber='{{ joinNumber }}' joinAvatarList='{{ joinAvatarList }}' adImageUrl='{{ adImageUrl }}' adName='{{ adName }}' adTime='{{ adTime }}' showShareModel='{{ showShareModel }}'
  adId='{{adId}}' bind:hideDialog='hideDialogListener'>
</share-detail>

<!--正在加载-->
<view class='load-more' hidden='{{!isShowLoadingMore}}'>
  <view class="weui-loadmore">
    <view class="weui-loading"></view>
    <view class="weui-loadmore__tips" style='color:#999999'>奔跑中🚗...</view>
  </view>
</view>

<!-- 规则弹框 -->
<rule-dialog showRuleDialog='{{ showRule }}' bind:btnclick='iKnow' bind:btnclickDetail='goRuleDetail' data-adId="{{ adId }}" data-serverId="{{ serverId }}" data-serverName='{{ serverName }}' data-serverAddress='{{ serverAddress }}'></rule-dialog>

<!-- 地址弹框 -->
<dialog-address showAddressDialog='{{ showAddressDialog }}' address='{{ address }}' phone='{{ phone }}'></dialog-address>

<!-- 注册认证弹框 -->
<dialog-auth showDialog='{{ showAuthDialog }}' imageSrc='{{ "https://wxapi.benpaobao.com/static/app_img/auth-icon.png" }}' btnStr='{{ authStr }}' status='{{ authStatus }}' content='{{ authContent }}' bind:action='handleActionTap'></dialog-auth>

<!-- 预约排队 -->
<model visible="{{ visible }}" title="预约排队确认" cancelText="暂不排队" confirmText="确认排队" cancelLoading="{{ cancelLoading }}" confirmLoading="{{ confirmLoading }}" bind:cancel="handleCancel" bind:confirm="handleConfirm">
  <view class='subscribe-wrapper'>
    <view class='subscribe-body'>
      <view class='b-queue-model-item'>排队序号: {{ serial_number }}</view>
      <view class='b-queue-model-item'>当前排队人数: {{ queue_count }}</view>
      <view class='b-queue-model-item'>需等待人数: {{ position }}</view>
    </view>
    <view class='b-queue-notify-text'>请及时关注公众号通知，查看排队情况</view>
  </view>
</model>

<!-- 轻提示 -->
<b-toast id="toast"></b-toast>